<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8">
    <script src="https://code.jquery.com/jquery-3.5.1.min.js"></script>
    <link rel="stylesheet" href="./html/style.css">
    <title>Bíblia NVA</title>
</head>
<body>
    <script>
    // Variaveis de escolha OPcionais de controle do usuario
    var op_livro, op_capitulos;

    // Nomes dos livros em ordem de Gênesis (1) a Apocalipse (66)
    const livro=["","Gênesis","Êxodo","Levítico","Números","Deuteronômio","Josué","Juízes","Rute","1 Samuel","2 Samuel","1 Reis","2 Reis","1 Crônicas","2 Crônicas","Esdras","Neemias","Ester","Jó","Salmos","Provérbios","Eclesiastes","Cânticos","Isaías","Jeremias","Lamentações","Ezequiel","Daniel","Oséias","Joel","Amós","Obadias","Jonas","Miquéias","Naum","Habacuque","Sofonias","Ageu","Zacarias","Malaquias","Mateus","Marcos","Lucas","João","Atos","Romanos","1 Coríntios","2 Coríntios","Gálatas","Efésios","Filipenses","Colossenses","1 Tessalonicenses","2 Tessalonicenses","1 Timóteo","2 Timóteo","Tito","Filemom","Hebreus","Tiago","1 Pedro","2 Pedro","1 João","2 João","3 João","Judas","Apocalipse"];

    // Variaveis de controle representa o livro e o capitulo atual.
    var set_livro=1
    var set_capitulo=1;

    // Variavel responsavel por guardar toda a biblia em json
    var bibliaNVA;

    // ini do document ready -> Assim que a pagina é carregada faça
    $(document).ready(function() {

    // Leio o json da biblia toda e carrego pra uma variavel;
    $.getJSON('./2 - SQL, JSON e CSV da Bíblia/bibliaNVA.json', function(biblia){
        bibliaNVA = biblia;
       limpa(); // Apenas para mostrar Genesis 1
    });

    // Escolha do Livro da biblia Genesis e Apocalipse
    $('select').on('change', function() {
        set_livro= this.value;
        set_capitulo=1;
        limpa();
    });

    // Escolha capitulo, resumidamente, carregue o capitulo clicado para uma var, limpa a tela e abra a biblia na var escolhida
    $( ".op_capitulos" ).on( "click", "p", function() {
        set_capitulo = this.id;
        limpa();
    });

    }); // fim do document ready

    // Limpa a tela para reescrever os versos escolhidos
    function limpa (){
        $(".op_capitulos").html("");
        $('#versos').html("");
        $("#op_livros").html("");
        bibliaNVA.forEach(mostre_versos);
        $("#versos").html($("#versos").html().replaceAll("Yahweh", "<b>Yahweh</b>").replaceAll("Deus", "<b>Deus</b>"));
    }

    // Percorre toda a biblia
    function mostre_versos(linha) {

    //Listo os livros para escolha no select
    if (linha.l != op_livro){

        if (set_livro==linha.l)
            $("#op_livros").append($('<option>', {value:linha.l, text:livro[linha.l], selected:true}));
        else
            $("#op_livros").append($('<option>', {value:linha.l, text:livro[linha.l]}));
        op_livro = linha.l;
    }

    // Listo capitulos do livro escolhido
    if (linha.l == set_livro) // Livro Atual listar capitulos
        if (linha.c != op_capitulos){ // apenas para nao repetir umas vez que cada versos contem livro, cap,

            if (set_capitulo==linha.c)
                $(".op_capitulos").append('<p style="background-color: #ccc;" id="'+linha.c+'">'+linha.c+'</p>')
                else
                $(".op_capitulos").append('<p id="'+linha.c+'">'+linha.c+'</p>');
            op_capitulos = linha.c;


        }

        // Listo versiculos do livro escolhido
        if (linha.l == set_livro)
            if (linha.c == set_capitulo){
                $('#livro').html(livro[linha.l]); // Nome do Livro
                $('#capitulos').html("<p id='c' id='ir_"+linha.l+"_"+linha.c+"'>" + linha.c + " </p>"); // Nome do Livro
                $('#versos').append('<sup>'+linha.n+'</sup>'+'<p id="'+linha.n+'">'+linha.v+'</p>');
            }

    }

    </script>
    <div class="row">
        <div class="col1">
            <img id="logo" src="./html/logo.png"><br>
            <h2>Bíblia NVA</h2><select id="op_livros">
            </select><br>
            <span class="op_capitulos"></span>
        </div>
        <div class="col2">
            <h1 id="livro"></h1>
            <span id="capitulos"></span>
            <p id="versos"></p>
        </div>
    </div>
</body>
</html>
